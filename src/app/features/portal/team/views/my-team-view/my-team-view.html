<app-content-layout-view 
  title="Mi Equipo" 
  subtitle="Conoce tu estructura, líderes y colaboradores.">

  @if (loading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Cargando estructura...</p>
    </div>

  } @else {
    
    <div class="animate-fade-in flex-column-gap">

      @if (team().supervisor; as boss) {
        <div class="leader-section">
          <h3 class="section-label">A quien reporto</h3>
          
          <div class="leader-container">
            <div class="connector-line down"></div>
            
            <app-team-card
              [name]="(boss.firstName || '') + ' ' + (boss.lastName || '')"
              [position]="boss.position?.name"
              [email]="boss.user?.email"
              role="BOSS"
              class="leader-card">
            </app-team-card>
          </div>
        </div>
      }

      @if (team().peers.length > 0) {
        <div class="peers-section">
          <h3 class="section-label">Mis Compañeros</h3>
          
          <div class="team-grid">
            @for (peer of team().peers; track peer.id) { <app-team-card 
                [name]="peer.firstName + ' ' + peer.lastName"
                [position]="peer.position?.name"
                [email]="peer.user?.email"
                role="PEER">
              </app-team-card>
            }
          </div>
        </div>
      }

      @if (team().subordinates.length > 0) {
        <div class="subordinates-section">
          <div class="divider-with-label">
            <span>Gente a mi cargo</span>
          </div>
          
          <div class="team-grid">
            @for (sub of team().subordinates; track sub.id) {
              <app-team-card 
                [name]="sub.firstName + ' ' + sub.lastName"
                [position]="sub.position?.name"
                [email]="sub.user?.email"
                role="SUBORDINATE">
              </app-team-card>
            }
          </div>
        </div>
      }

      @if (!team().supervisor && team().peers.length === 0 && team().subordinates.length === 0) {
        <div class="empty-state">
          <mat-icon>group_off</mat-icon>
          <p>No se encontró información de equipo asignada.</p>
        </div>
      }

    </div>
  }

</app-content-layout-view>