<div class="upload-container">
  
  <div class="modal-header">
    <h2>Subir Documento</h2>
    <button mat-icon-button (click)="close()"><mat-icon>close</mat-icon></button>
  </div>

  <div class="modal-body">
    
    <div class="drop-zone" 
         [class.dragging]="isDragging()"
         (dragover)="onDragOver($event)" 
         (dragleave)="onDragLeave($event)" 
         (drop)="onDrop($event)">
      
      <ng-container *ngIf="!file(); else fileSelectedTemplate">
        <div class="icon-circle">
          <mat-icon>cloud_upload</mat-icon>
        </div>
        <h3>Arrastra tu archivo aquí</h3>
        <p>o <span class="highlight" (click)="fileInput.click()">explora en tu equipo</span></p>
        <span class="meta">Soporta PDF, JPG, PNG (Máx 10MB)</span>
      </ng-container>

      <ng-template #fileSelectedTemplate>
        <div class="file-preview">
          <mat-icon class="file-icon">description</mat-icon>
          <div class="file-info">
            <span class="name">{{ file()?.name }}</span>
            <span class="size">{{ (file()?.size || 0) / 1024 | number:'1.0-2' }} KB</span>
          </div>
          <button mat-icon-button color="warn" (click)="file.set(null)" [disabled]="isUploading()">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </ng-template>

      <input #fileInput type="file" hidden (change)="onFileSelected($event)">
    </div>

    <div class="progress-area" *ngIf="isUploading()">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      <span>Subiendo documento...</span>
    </div>

  </div>

  <div class="modal-actions">
    <button mat-button (click)="close()" [disabled]="isUploading()">Cancelar</button>
    <button mat-flat-button color="primary" 
            [disabled]="!file() || isUploading()" 
            (click)="upload()">
      {{ isUploading() ? 'Guardando...' : 'Subir Archivo' }}
    </button>
  </div>

</div>
