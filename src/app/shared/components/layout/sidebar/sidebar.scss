/* =========================================================
   SIDEBAR - DISE√ëO SOBRIO & MODERNO
   ========================================================= */

:host {
  display: block;
  height: 100%;
}

.sidebar {
  width: 260px;
  height: 100%;
  background: var(--bg-surface);
  border-right: 1px solid var(--border-subtle);
  display: flex;
  flex-direction: column;
  transition: width 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  overflow: visible; 

  /* TIPOGRAF√çA UNIFICADA */
  font-family: var(--font-main); /* üëà Usamos la variable global */

  /* --- MODO COLAPSADO (80px) --- */
  &.collapsed {
    width: 80px;

    .sidebar-header { padding: 0; justify-content: center; }
    .nav-item { justify-content: center; padding: 0; width: 48px; margin: 4px auto; } /* Centrado perfecto */
    .nav-label, .chevron, .group-children, .logo-text, .user-info { display: none !important; }
    .logo-box { margin: 0; }
  }
}

/* =========================================================
   1. HEADER
   ========================================================= */
.sidebar-header {
  height: 80px;
  display: flex;
  align-items: center;
  padding: 0 24px;
  flex-shrink: 0;
  
  .logo-box {
    width: 40px; height: 40px; min-width: 40px;
    background-color: var(--color-primary);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    color: white;
    box-shadow: var(--shadow-sm);
    
    img { width: 24px; height: 24px; }
  }

  .logo-text {
    margin-left: 12px;
    font-size: var(--text-xl);       /* ‚úÖ Variable */
  font-weight: var(--weight-bold); /* ‚úÖ Variable */
    color: var(--text-main);
    letter-spacing: -0.5px;
    white-space: nowrap;
  }
}

/* =========================================================
   2. NAVEGACI√ìN
   ========================================================= */
.sidebar-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 16px 0;
}

.nav-list {
  display: flex; flex-direction: column; gap: 4px; /* Espacio vertical entre botones */
}

/* --- ITEMS NIVEL 1 (Estilo Bot√≥n Flotante) --- */
.nav-item {
  position: relative;
  display: flex;
  align-items: center;
  
  /* AQU√ç EST√Å LA MAGIA PARA QUE NO SE VEA B√ÅSICO: */
  margin: 0 12px;           /* Separaci√≥n de los bordes laterales */
  padding: 10px 16px;       /* Relleno interno c√≥modo */
  border-radius: 8px;       /* Bordes redondeados siempre */
  
  color: var(--text-secondary);
  text-decoration: none;
  cursor: pointer;
font-size: var(--text-sm);         /* ‚úÖ Variable (14px es est√°ndar para men√∫s) */
  font-weight: var(--weight-medium); /* ‚úÖ Variable */
  transition: all 0.2s ease-in-out;
  min-height: 48px;
  white-space: nowrap;

  .nav-icon {
    margin-right: 12px;
    font-size: 22px; width: 22px; height: 22px;
    color: var(--text-muted); /* Iconos sutiles por defecto */
    transition: color 0.2s;
  }
  
  .nav-label { flex: 1; }
  
  .chevron {
    font-size: 20px;
    color: var(--text-muted);
    transition: transform 0.3s ease;
  }

  /* HOVER: Sutil y elegante */
  &:hover {
    background-color: var(--bg-hover);
    color: var(--text-main);
    .nav-icon { color: var(--text-main); }
  }

  /* ACTIVO: Estilo "Pill" (Pastilla) */
  &.active {
    background-color: var(--color-primary-soft); /* #fff0f3 */
    color: var(--color-primary); /* Guinda */
   font-weight: var(--weight-semibold); /* ‚úÖ Variable */

    .nav-icon, .chevron { color: var(--color-primary); }
    
    /* En lugar de una barra lateral, usamos el fondo completo para indicar activo */
  }

  /* Header de Grupo Abierto */
  &.group-header.open {
    color: var(--text-main);
    background-color: rgba(0,0,0,0.02); /* Gris muy muy tenue */
    .chevron { transform: rotate(180deg); color: var(--color-primary); }
  }
}

/* --- ITEMS NIVEL 2 (Hijos) --- */
.group-children {
  margin: 4px 12px 4px 24px; /* Indentaci√≥n visual */
  padding-left: 10px;
  border-left: 2px solid var(--border-color); /* L√≠nea gu√≠a fina */
  
  .child-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    margin-bottom: 2px;
    border-radius: 6px; /* Bordes suaves en hijos */
    
    color: var(--text-secondary);
    text-decoration: none;
   font-size: var(--text-sm); /* ‚úÖ Uniformidad: Mismo tama√±o que el padre */
    transition: all 0.2s;

    &:hover {
      color: var(--color-primary);
      background-color: var(--bg-hover);
    }

    &.active {
      color: var(--color-primary);
      background-color: var(--color-primary-soft);
      font-weight: 600;
    }
  }
}

/* =========================================================
   3. POPUP MENU (Colapsado)
   ========================================================= */
::ng-deep .sidebar-popup-menu {
  background-color: var(--bg-surface);
  border-radius: 12px !important;
  margin-left: 12px; 
  box-shadow: var(--shadow-float) !important;
  padding: 8px !important;
  min-width: 220px !important;
  border: 1px solid var(--border-subtle);
  font-family: var(--font-main) !important; /* üëà Fuente global */

  .mat-mdc-menu-item {
    border-radius: 8px;
    color: var(--text-secondary);
    font-size: 0.9rem;
    min-height: 44px;
    
    mat-icon { margin-right: 12px; color: var(--text-muted); }

    &:hover {
      background-color: var(--bg-hover);
      color: var(--color-primary);
    }

    &.active-sublink {
      background-color: var(--color-primary-soft);
      color: var(--color-primary);
      font-weight: 600;
      mat-icon { color: var(--color-primary); }
    }
  }
}

/* =========================================================
   4. FOOTER
   ========================================================= */
.sidebar-footer {
  /* Quitamos el borde superior para un look m√°s limpio */
  padding: 16px;
  margin-top: auto;

  .user-card {
    display: flex;
    align-items: center;
    gap: 12px; // Espacio entre avatar y texto
    padding: 12px;
    background: rgba(0,0,0,0.03); // Opcional: fondo sutil
    border-radius: 12px;
    overflow: hidden; // Para cortar el texto si es muy largo
    transition: all 0.3s;
    // Cuando el sidebar est√° colapsado, centramos el avatar
    .sidebar.collapsed & {
      justify-content: center;
      padding: 12px 0;
      // Ocultamos el texto (aunque el @if en HTML ya lo hace, esto es doble seguridad)
      .user-info { display: none; }}
    
    &:hover {
      background-color: var(--bg-hover);
      border-color: var(--border-color);
    }

    .avatar {
      width: 36px; height: 36px; min-width: 36px;
      background-color: var(--bg-hover);
      color: var(--text-secondary);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700;
      font-size: 0.85rem;
    }
    
    .user-info {
      display: flex; flex-direction: column; overflow: hidden;
      .name { font-size: var(--text-sm);
  font-weight: var(--weight-bold);; color: var(--text-main); }
      .role { font-size: var(--text-xs);; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }
    }
  }
}

/* UTILS */
.fade-in { animation: fadeIn 0.3s forwards; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.expand-animation { animation: slideDown 0.2s ease-out; }
@keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

.custom-scroll {
  &::-webkit-scrollbar { width: 4px; }
  &::-webkit-scrollbar-track { background: transparent; }
  &::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
  &:hover::-webkit-scrollbar-thumb { background: #94a3b8; }
}